@model IEnumerable<ApplicationUser>

@{
	ViewData["Title"] = "Клиенти";
	string search = ViewBag.Search as string ?? string.Empty;
}

<div class="d-flex justify-content-between align-items-center mb-3">
	<h2 class="pink-title mb-0">Клиенти</h2>
	<div class="d-flex gap-2">
		<a asp-controller="Admin" asp-action="TopClients" class="btn btn-outline-pink">🔝 ТОП Клиенти</a>
		<a asp-controller="Admin" asp-action="CreateClient" class="btn btn-baby-green">➕ Добави</a>
	</div>
</div>


<form method="get" class="card card-body filter-card mb-3">
	<label class="form-label pink-label">Търсене (име, имейл или телефон)</label>
	<div class="row g-2">
		<div class="col-md-12">
			<input name="search" value="@search" class="form-control pink-input" placeholder="Име / Имейл / Телефон" />
		</div>
	</div>
	<div class="row g-3 my-2">
		<div class="col-md-2 d-grid">
			<button type="submit" class="btn btn-softpink">Филтрирай</button>
		</div>
		<div class="col-md-2 d-grid">
			<a asp-controller="Admin" asp-action="Clients" class="btn btn-outline-secondary">
				Изчисти
			</a>
		</div>
	</div>
</form>

@if (!Model.Any())
{
	<div class="alert alert-info">Няма намерени клиенти.</div>
}
else
{
	@if (TempData["Error"] != null)
	{
		<div class="alert alert-warning">@TempData["Error"]</div>
	}
	<div class="table-responsive">
		<table class="table table-striped table-hover align-middle">
			<thead>
				<tr>
					<th>Име</th>
					<th>Имейл</th>
					<th>Телефон</th>
					<th>Брой предишни наеми</th>
					<th class="text-end">Действия</th>
				</tr>
			</thead>
			<tbody>
				@foreach (ApplicationUser client in Model)
				{
					<tr>
						<td>@client.FirstName @client.LastName</td>
						<td>@(client.Email ?? "-")</td>
						<td>@(client.PhoneNumber ?? "-")</td>
						<td>@client.PreviousRentalsCount</td>
						<td class="d-flex justify-content-end gap-2">
								<a asp-controller="Admin" asp-action="EditClient" asp-route-userId="@client.Id" class="btn btn-baby-yellow">Редакция</a>
								<form asp-controller="Admin" asp-action="DeleteClient" method="post" class="d-inline">
									<input type="hidden" name="userId" value="@client.Id" />
									<button type="submit" class="btn btn-baby-red">
										Изтрий
									</button>
								</form>
						</td>
					</tr>
				}
			</tbody>
		</table>
	</div>
}
