@model Car
@using CarRental.Helpers
@using CarRental.Enums

@{
	ViewData["Title"] = "Детайли за автомобил";
}

<h2 class="pink-title mb-3">Детайли за автомобил</h2>

<div class="row g-4">
	<div class="col-6">
		@if (!string.IsNullOrEmpty(Model.ImageUrl))
		{
			<img src="@Model.ImageUrl"
				 class="img-fluid rounded-3"
				 style="width:100%; max-height:400px; object-fit:cover;"
				 alt="Снимка на автомобил" />
		}
		else
		{
			<div class="d-flex justify-content-center align-items-center bg-light rounded"
				 style="height:400px;">
				<span class="text-muted">Няма снимка</span>
			</div>
		}
	</div>

	<div class="col-6">
		<h2 class="mb-1">@Model.Brand @Model.Model</h2>
		<div class="text-muted mb-3">Рег. № @Model.RegistrationNumber</div>

		<div class="d-flex flex-wrap gap-2 mb-3">
			@if (Model.Status == CarStatus.Available)
			{
				<span class="badge bg-white text-success border border-success">Наличен</span>
			}
			else if (Model.Status == CarStatus.Rented)
			{
				<span class="badge bg-white text-danger border border-danger">Наета</span>
			}
			else if (Model.Status == CarStatus.InService)
			{
				<span class="badge bg-white text-dark border border-warning">В сервиз</span>
			}
			<span class="badge bg-light text-dark border">@Model.Type.GetDisplayName()</span>
			<span class="badge bg-light text-dark border">@Model.Year г.</span>
		</div>

		<div class="card card-body filter-card mb-3">
			<div>
				<h5>
					Цена на ден:
					<span class="text-success">
						@(Model.PriceTariff != null ? Model.PriceTariff.PricePerDay.ToString("0.00") : "-") €
					</span>
				</h5>
			</div>
			<div class="text-muted small">
				Цената се определя според тарифата за типа автомобил.
			</div>
		</div>

		<div class="card card-body filter-card mb-3">
			<h5 class="mb-2">Информация</h5>
			<div class="row">
				<div class="col-6 text-muted">Марка:</div>
				<div class="col-6">@Model.Brand</div>

				<div class="col-6 text-muted">Модел:</div>
				<div class="col-6">@Model.Model</div>

				<div class="col-6 text-muted">Година:</div>
				<div class="col-6">@Model.Year</div>

				<div class="col-6 text-muted">Тип:</div>
				<div class="col-6">@Model.Type.GetDisplayName()</div>

				<div class="col-6 text-muted">Статус:</div>
				<div class="col-6">@Model.Status.GetDisplayName()</div>
			</div>
		</div>

		<div class="d-flex gap-2 flex-wrap justify-content-end">
			<a asp-action="Index" class="btn btn-outline-secondary">Назад</a>

			@if (User.IsInRole("Client") && Model.Status != CarStatus.InService)
			{
				<a asp-controller="RentalContracts" asp-action="Create" asp-route-carId="@Model.Id"
				   class="btn btn-baby-green">
					Наеми
				</a>
			}

			@if (User.IsInRole("Administrator"))
			{
				@if (Model.Status == CarStatus.Rented)
				{
					<button class="btn btn-baby-grey" disabled>Редакция</button>
				}
				else
				{
					<a asp-controller="Cars" asp-action="Edit" asp-route-id="@Model.Id"
					   class="btn btn-baby-yellow">
						Редакция
					</a>
				}
				<a asp-action="Delete" asp-route-id="@Model.Id" class="btn btn-baby-red">Изтрий</a>
			}
		</div>
	</div>

</div>

